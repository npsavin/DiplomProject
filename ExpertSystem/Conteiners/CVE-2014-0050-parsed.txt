{result:[{name : "CVE-2014-0050",
symptom : "This can help administrators and developers understand if a certain URL is vulnerable to the attack (but needs to be tested on all URLs) ; Download CVE-2014-0050   Defend yourself Trustwave Spiderlabs research team recommends taking the following actions: A) Once available, update your software to one of the following versions: B)      You may choose to apply the appropriate patch:   ModSecurity Commercial Rule Set The  ModSecurity commercial rule set  was updated and protects against the attack",
threat : "This can help administrators and developers understand if a certain URL is vulnerable to the attack (but needs to be tested on all URLs) ; Download CVE-2014-0050   Defend yourself Trustwave Spiderlabs research team recommends taking the following actions: A) Once available, update your software to one of the following versions: B)      You may choose to apply the appropriate patch:   ModSecurity Commercial Rule Set The  ModSecurity commercial rule set  was updated and protects against the attack",
consequences : "The calculation is as follows: boundary.length > bufSize – 1 – BOUNDARY_PREFIX.length = 4096 – 1 – 4 = 4091 Note: parts of the code were copied into the org.apache.tomcat.util.http.fileupload package in Apache Tomcat, causing it to be affected ; What is Multipart?  Multipart is often used in HTTP for the purpose of uploading files (more details can be found in  RFC 2046 ) ; This magic line is the boundary value and should be random enough that it doesn’t appear in the actual content sent ; Such complexity reduces the chances of the boundary appearing in the binary blob of the file being uploaded, so the different parts of the message can be easily detected even by the human eye:    Creating the exploit So let’s get Apache Tomcat installed and try to send more than 4091 characters in the boundary field to the Apache Tomcat Manager application ; I wrote a small Ruby proof-of-concept exploit to help administrators try and recreate the Denial-of-Service state on QA and staging environments ;   WebDefend It is possible to add the following user defined rule  in block mode  to detect and mitigate the attack: SecRule REQUEST_HEADERS:Content-Type \"@rx .{4000}\" For more information on how to create user-defined rules, please refer to  http://blog.spiderlabs.com/2013/04/restricting-adobe-cq-admin-logins-with-trustwave-wafs.html Note: Due to the low chances of a false detection (false positive) and the simplicity of the exploit, we highly recommend setting this rule to BLOCK and disabling simulation mode for this rule if you are concerned about Denial-of-Service (and suspect that your site is using one of the affected technologies) ; Apache Tomcat 6 was not affected",
countermeasures : "The most significant difference I detected was in the “MultipartStream” class code of the package: http://svn.apache.org/viewvc/commons/proper/fileupload/trunk/src/main/java/org/apache/commons/fileupload/MultipartStream.java?r1=1564788&r2=1565143&diff_format=h The fixed code has an extra “if” condition (line number 330) that validates the length of the multipart boundary to be shorter than  4091  characters, raising an exception if that’s not the case ; Download CVE-2014-0050   Defend yourself Trustwave Spiderlabs research team recommends taking the following actions: A) Once available, update your software to one of the following versions: B)      You may choose to apply the appropriate patch:   ModSecurity Commercial Rule Set The  ModSecurity commercial rule set  was updated and protects against the attack ;   WebDefend It is possible to add the following user defined rule  in block mode  to detect and mitigate the attack: SecRule REQUEST_HEADERS:Content-Type \"@rx .{4000}\" For more information on how to create user-defined rules, please refer to  http://blog.spiderlabs.com/2013/04/restricting-adobe-cq-admin-logins-with-trustwave-wafs.html Note: Due to the low chances of a false detection (false positive) and the simplicity of the exploit, we highly recommend setting this rule to BLOCK and disabling simulation mode for this rule if you are concerned about Denial-of-Service (and suspect that your site is using one of the affected technologies) ; Posted by  Oren Hafif  on 11 February 2014 at 11:46 in  Application Security ,  Penetration Testing ,  Security Research ,  Tools | Permalink Comments Just an update that the fix for CVE-2014-0050 is included in Apache Tomact 8.0.3 released 11 Feb 2014 and in Apache Tomcat 7.0.52 released 14 Feb 2014"
looses : "This can help administrators and developers understand if a certain URL is vulnerable to the attack (but needs to be tested on all URLs) ; Download CVE-2014-0050   Defend yourself Trustwave Spiderlabs research team recommends taking the following actions: A) Once available, update your software to one of the following versions: B)      You may choose to apply the appropriate patch:   ModSecurity Commercial Rule Set The  ModSecurity commercial rule set  was updated and protects against the attack"
}]}