{result:[{name : "CVE-2014-0090",
symptom : "Once users log in with the session id, attackers could also access the whole site with the user\'s privilege ; At host A, get a new session_id by accessing /users/login with any existing cookie removed ; At host B, access /users/login through http proxy ; modify _session_id in Set-cookie header with the one got in host A ; At host B, access /users/login and verify if the injected _session_id is using in Cookie header ; At host B, log in with admin(or any user) account ; User at host A can access the application bypassing authentication Remedy advice  ; The security bug is that we take the session ID from the request, then escalate its privileges by assigning a current user so an attacker with a copy of the session ID (or who planted it into a user\'s request) gets escalated privileges",
threat : "Intercept a request and delete Cookie header if exists ; If you delete your session ID then you\'re testing something else",
consequences : "The security bug is that we take the session ID from the request, then escalate its privileges by assigning a current user so an attacker with a copy of the session ID (or who planted it into a user\'s request) gets escalated privileges",
countermeasures : "https://www.owasp.org/index.php/Session_fixation 0001-fixes-4457-Session-fixation-new-session-IDs-are-not-.patch  - v1 patch  (1000 Bytes) Dominic Cleal, 03/10/2014 08:12 am 0002-fixes-4457-Session-fixation-new-session-IDs-are-not-.patch (1.58 KB) Joseph Magen, 03/17/2014 08:30 am 0003-fixes-4457-Session-fixation-new-session-IDs-are-not-.patch (1.69 KB) Joseph Magen, 03/17/2014 05:05 pm 0001-fixes-4457-Session-fixation-new-session-IDs-are-not-.patch  - v4 patch  (14.9 KB) Dominic Cleal, 03/18/2014 03:52 pm Associated revisions Revision cfa4b526  ; Added by  Dominic Cleal 2 months  ago fixes  #4457  - Session fixation, new session IDs are not generated on login (CVE-2014-0090) History #1  Updated by  Dominic Cleal 3 months  ago #2  Updated by  Dominic Cleal 3 months  ago #3  Updated by  Dominic Cleal 3 months  ago #4  Updated by  Joseph Magen 3 months  ago patch sent by email #5  Updated by  Dominic Cleal 3 months  ago Please just upload patches here, thanks ; Are the API controllers vulnerable too, since they also use the  session ? #7  Updated by  Joseph Magen 2 months  ago changes in v2 patch attached 1 ; It doesn\'t create a new session session ; Thanks Joseph! I think we can release this tomorrow ; #15  Updated by  Dominic Cleal 2 months  ago #16  Updated by  Dominic Cleal 2 months  ago Attached a new patch for review, which resets the session when the user is authenticated via UsersController#login and also via Foreman::Controller::Authentication (used for SSO), but not when it\'s an API request (where we don\'t store the user in the session) ; On session expiry (that is, the time limit by the idle_timeout setting) then the current context is preserved with this patch"
looses : "Intercept a request and delete Cookie header if exists ; If you delete your session ID then you\'re testing something else"
}]}